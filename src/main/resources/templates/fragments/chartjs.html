<th:block th:fragment="header">
  <style>
  body {
    background-color: #f4e9cd; /* Retro beige */
    /*font-family: 'Courier New', Courier, monospace;*/ /* Vintage typewriter font */
  }
  
  #chartContainer {
    height: 400px; /* Increased height for the chart */
    width: 100%;
    border: 1px solid #2b2b2b; /* Retro black frame */
    background-color: #f4e9cd;
    padding: 10px;
  }
  
  .canvasjs-chart-legend {
    font-size: 8px; /* Reduced size of the legend text */
  }
  
  .canvasjs-stocknavigator-slider {
    height: 8px; /* Reduced height of the slider */
  }
  
  .canvasjs-stocknavigator-sliderHandle {
    width: 8px; /* Reduced width of the slider handle */
    height: 16px; /* Reduced height of the slider handle */
  }
  </style>
  <script th:inline="javascript">
  window.onload = function() {
      // Function to format numbers as currency
      function formatCurrency(value, locale, currency) {
          return new Intl.NumberFormat(locale, { style: "currency", currency: currency }).format(value);
      }
       
      // Format date from epoch (milliseconds) to "MM/DD/YYYY" format
      function formatDate(epoch, locale) {
          return new Date(epoch).toLocaleDateString(locale); // Convert epoch to Date and format
      }
      
    /*<![CDATA[*/
      
      var dataPointsList = /*[[${datapointsUsd}]]*/ 'null';
      var dataPointsListEur = /*[[${datapointsEur}]]*/ 'null';
      var cashBalanceDataPoints = /*[[${datapointsCash}]]*/ 'null';
      
      // Loop to format each data point for USD
      dataPointsList = dataPointsList.map(dp => {
          dp.label = `${formatDate(dp.x, "en-US")} - ${formatCurrency(dp.y, "en-US", "USD")}`;
          return dp;
      });
  
      // Loop to format each data point for EUR
      dataPointsListEur = dataPointsListEur.map(dp => {
          dp.label = `${formatDate(dp.x, "de-DE")} - ${formatCurrency(dp.y, "de-DE", "EUR")}`;
          return dp;
      });
      
      // Format Cash Balance
      cashBalanceDataPoints = cashBalanceDataPoints.map(dp => {
          dp.label = `Date: ${formatDate(dp.x)} - ${formatCurrency(dp.y, "en-US", "USD")}`;
          return dp;
      });
      
      var chart = new CanvasJS.StockChart("chartContainer", {
        animationEnabled: true,
        exportEnabled: true,
        theme: "light2",
        backgroundColor: "#f4e9cd", /* Apply background to entire chart */
          title: {
            text: "Net Liquidity",
              fontColor: "#5e4a3d",
              fontFamily: "Courier New",
              fontSize: 18, /* Reduced font size for the title */
              backgroundColor: "#d7c4a0",
              padding: 10
          },
        charts: [{
          backgroundColor: "#f4e9cd", /* Retro beige */
              axisX:{      
                  valueFormatString: "DD-MMM" ,
                  labelAngle: -50,
                  labelFontColor: "#5e4a3d"
              },
            axisY:{
              valueFormatString: "#,###",
            },
            data: [
          {
                      type: "area",
                      name: "Cash Balance (USD)",
                      showInLegend: true,
                      color: "#e3b23c",  // Gold line for Cash Balance
                      fillOpacity: 0.5,  // Semi-transparent fill
                      markerColor: "#ffcc00",
                      lineThickness: 1,
                      dataPoints: cashBalanceDataPoints
                  },
              {
                    type: "line",
                    name: "USD",
                    xValueType: "dateTime",
                    showInLegend: true,
                    color: "#d16666", /* Vintage red-orange */
                    markerColor: "#f08c8c",
                    lineThickness: 2,
                    dataPoints: dataPointsList
                },
                {
                    type: "line",
                    name: "EUR",
                    xValueType: "dateTime",
                    showInLegend: true,
                    color: "#008b8b", /* Retro blue-green */
                    markerColor: "#20b2aa",
                    lineThickness: 2,
                dataPoints: dataPointsListEur
                }
            ],
         }],
           navigator: {
               backgroundColor: "#f4e9cd", /* Apply retro beige to navigator */
               fontSize: 12, // Reduced font size for the legend
               slider: {
                 backgroundColor: "#f4e9cd", /* Apply retro beige to navigator */
                 height: 10,  /* Reduced height of the slider */
                  minimum: new Date(dataPointsList[0].x * 1000),
                  maximum: new Date()             
               }
           },
           legend: {
             backgroundColor: "#f4e9cd", /* Apply retro beige to navigator */
               fontColor: "#5e4a3d",
               fontFamily: "Courier New",
               fontSize: 12, // Reduced font size for the legend
               cursor: "pointer",  // Make the legend item clickable
               itemclick: function (e) {
                   if (typeof (e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
                       e.dataSeries.visible = false;  // Hide the series
                   } else {
                       e.dataSeries.visible = true;  // Show the series
                   }
                   chart.render();  // Re-render the chart to apply the changes
               }
           },
      });
  
      chart.render();
  } 
  </script>
</th:block>